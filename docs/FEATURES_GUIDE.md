# 功能使用指南

本文档详细介绍如何使用笔记应用的各项功能。

## 📋 目录

1. [文件夹管理](#文件夹管理)
2. [协作编辑](#协作编辑)
3. [图片上传](#图片上传)
4. [导出功能](#导出功能)
5. [移动端支持](#移动端支持)
6. [搜索增强](#搜索增强)
7. [版本历史](#版本历史)
8. [模板系统](#模板系统)
9. [Webhook 集成](#webhook-集成)
10. [AI 功能](#ai-功能)

---

## 文件夹管理

### 功能入口
- **位置**: 仪表板左侧边栏
- **移动端**: 底部导航 → 文件夹图标

### 使用方法

#### 创建文件夹
1. 点击左侧边栏的 "新建文件夹" 按钮
2. 输入文件夹名称
3. 选择父文件夹（可选，用于创建嵌套文件夹）
4. 点击 "创建"

#### 嵌套文件夹
- 创建文件夹时选择父文件夹
- 支持无限层级嵌套
- 文件夹树自动展开/折叠

#### 拖放操作
- **拖动笔记**: 将笔记拖到文件夹上进行移动
- **拖动文件夹**: 将文件夹拖到另一个文件夹上创建嵌套
- **视觉反馈**: 拖动时会显示放置目标高亮

#### 面包屑导航
- 顶部显示当前位置路径
- 点击任意层级快速跳转
- 自动更新当前位置

---

## 协作编辑

### 功能入口
- **位置**: 笔记编辑页面
- **按钮**: 编辑器工具栏 → "分享" 按钮

### 使用方法

#### 邀请协作者
1. 打开要分享的笔记
2. 点击工具栏的 "分享" 按钮
3. 输入协作者的邮箱地址
4. 选择权限级别：
   - **查看**: 只能查看笔记
   - **编辑**: 可以编辑笔记内容
   - **管理**: 可以管理协作者和删除笔记
5. 点击 "邀请"

#### 实时协作
- **在线状态**: 右上角显示当前在线的协作者头像
- **光标位置**: 看到其他人的光标位置（不同颜色）
- **实时同步**: 编辑内容实时同步给所有协作者
- **冲突解决**: 自动合并并发编辑，使用 CRDT 算法

#### 公开分享
1. 点击 "分享" 按钮
2. 启用 "公开链接"
3. 复制生成的链接
4. 任何人都可以通过链接查看笔记（只读）

### 注意事项
⚠️ **需要启动 WebSocket 服务器**
```bash
cd note-app
npm run dev:collab
```

---

## 图片上传

### 功能入口
- **位置**: 笔记编辑器
- **方式**: 粘贴、拖放、工具栏按钮

### 使用方法

#### 方式 1: 粘贴上传
1. 复制图片（截图、文件等）
2. 在编辑器中按 `Ctrl+V` (Windows) 或 `Cmd+V` (Mac)
3. 图片自动上传并插入

#### 方式 2: 拖放上传
1. 从文件管理器拖动图片文件
2. 放到编辑器区域
3. 图片自动上传并插入

#### 方式 3: 工具栏按钮
1. 点击编辑器工具栏的图片图标
2. 选择本地图片文件
3. 图片自动上传并插入

### 图片功能
- **自动优化**: 自动压缩和优化图片大小
- **懒加载**: 滚动到可见区域才加载
- **灯箱预览**: 点击图片查看大图
- **响应式**: 自动适配不同屏幕尺寸

### 支持格式
- JPG/JPEG
- PNG
- GIF
- WebP
- SVG

---

## 导出功能

### 功能入口
- **位置**: 笔记编辑页面
- **按钮**: 编辑器工具栏 → "导出" 按钮

### 使用方法

#### 导出为 Markdown
1. 点击 "导出" 按钮
2. 选择 "Markdown (.md)"
3. 点击 "下载"
4. 文件保存到本地

#### 导出为 PDF
1. 点击 "导出" 按钮
2. 选择 "PDF (.pdf)"
3. 选择样式（可选）：
   - 默认样式
   - GitHub 样式
   - 学术论文样式
4. 点击 "下载"

#### 导出为 HTML
1. 点击 "导出" 按钮
2. 选择 "HTML (.html)"
3. 选择是否包含样式
4. 点击 "下载"

### 导出选项
- **包含图片**: 自动嵌入图片到导出文件
- **包含元数据**: 包含标题、标签、创建时间等
- **格式保留**: 保留 Markdown 格式和样式

---

## 移动端支持

### PWA 安装

#### iOS (Safari)
1. 打开网站
2. 点击分享按钮
3. 选择 "添加到主屏幕"
4. 点击 "添加"

#### Android (Chrome)
1. 打开网站
2. 点击菜单按钮（三个点）
3. 选择 "安装应用"
4. 点击 "安装"

### 移动端功能

#### 底部导航
- **首页**: 返回仪表板
- **搜索**: 搜索笔记和文件夹
- **新建**: 创建新笔记
- **功能**: 查看所有功能

#### 手势操作
- **左滑**: 删除笔记
- **右滑**: 标记为收藏
- **下拉刷新**: 刷新笔记列表
- **双击**: 快速编辑

#### 键盘优化
- **自动滚动**: 键盘弹出时自动滚动到光标位置
- **工具栏**: 键盘上方显示快捷工具栏
- **快捷键**: 支持常用 Markdown 快捷键

### PWA 设置
- **位置**: 设置 → PWA 设置
- **选项**:
  - 启用离线模式
  - 自动更新
  - 通知权限
  - 后台同步

---

## 搜索增强

### 功能入口
- **位置**: 顶部导航栏搜索框
- **快捷键**: `Ctrl+K` (Windows) 或 `Cmd+K` (Mac)

### 搜索范围
- 笔记标题
- 笔记内容
- 文件夹名称
- 标签名称

### 搜索技巧

#### 基础搜索
直接输入关键词，自动搜索所有内容

#### 高级搜索
- `title:关键词` - 只搜索标题
- `tag:标签名` - 按标签筛选
- `folder:文件夹名` - 按文件夹筛选
- `date:2024-01-01` - 按日期筛选

#### 搜索结果
- **统一显示**: 笔记和文件夹混合显示
- **高亮匹配**: 关键词高亮显示
- **快速预览**: 鼠标悬停显示预览
- **排序**: 按相关度、时间、标题排序

---

## 版本历史

### 功能入口
- **位置**: 笔记编辑页面
- **按钮**: 编辑器工具栏 → "历史" 按钮

### 使用方法

#### 查看历史版本
1. 打开笔记
2. 点击 "历史" 按钮
3. 查看版本列表
4. 点击任意版本查看内容

#### 版本对比
1. 选择两个版本
2. 点击 "对比"
3. 查看差异（红色=删除，绿色=新增）

#### 恢复版本
1. 选择要恢复的版本
2. 点击 "恢复"
3. 确认恢复操作
4. 当前内容被替换为历史版本

### 版本信息
- **时间戳**: 精确到秒
- **作者**: 显示编辑者
- **变更摘要**: 自动生成变更说明
- **大小**: 显示内容大小

---

## 模板系统

### 功能入口
- **位置**: 顶部导航 → "功能" → "模板系统"
- **直接访问**: `/templates`

### 使用方法

#### 使用模板
1. 访问模板页面
2. 浏览可用模板
3. 点击 "使用模板"
4. 自动创建新笔记并填充模板内容

#### 创建模板
1. 创建一个笔记
2. 编写模板内容
3. 点击 "保存为模板"
4. 输入模板名称和描述
5. 选择模板分类

#### 管理模板
- **编辑**: 修改模板内容
- **删除**: 删除不需要的模板
- **分享**: 分享模板给其他用户
- **导入**: 从文件导入模板

### 内置模板
- 📝 **会议记录**: 会议时间、参与者、议程、决议
- 📚 **读书笔记**: 书名、作者、摘要、感想
- 💡 **项目计划**: 目标、任务、时间线、资源
- 📊 **周报**: 本周工作、下周计划、问题风险
- 🎯 **OKR**: 目标、关键结果、进度跟踪

---

## Webhook 集成

### 功能入口
- **位置**: 设置 → Webhook 配置
- **直接访问**: `/settings/webhooks`

### 使用方法

#### 创建 Webhook
1. 访问 Webhook 配置页面
2. 点击 "添加 Webhook"
3. 输入 Webhook URL
4. 选择触发事件
5. 配置请求头（可选）
6. 点击 "保存"

#### 触发事件
- `note.created` - 笔记创建
- `note.updated` - 笔记更新
- `note.deleted` - 笔记删除
- `note.shared` - 笔记分享
- `folder.created` - 文件夹创建
- `folder.updated` - 文件夹更新

#### Webhook 负载
```json
{
  "event": "note.created",
  "timestamp": "2024-12-08T10:00:00Z",
  "data": {
    "id": "note-id",
    "title": "笔记标题",
    "content": "笔记内容",
    "userId": "user-id"
  }
}
```

#### 测试 Webhook
1. 点击 Webhook 旁的 "测试" 按钮
2. 查看测试结果
3. 检查响应状态和内容

### 使用场景
- **自动备份**: 笔记更新时自动备份到其他服务
- **通知集成**: 发送通知到 Slack、Discord 等
- **数据同步**: 同步到其他系统
- **自动化工作流**: 触发自动化任务

---

## AI 功能

### 功能入口
- **位置**: 顶部导航 → "AI 功能"
- **直接访问**: `/ai`

### AI 摘要生成

#### 自动生成
1. 创建或编辑笔记
2. 输入内容（至少 100 字）
3. 保存笔记
4. AI 自动生成摘要

#### 手动生成
1. 打开笔记
2. 点击 "重新生成摘要" 按钮
3. 等待 AI 生成
4. 查看新摘要

### AI 标签建议

#### 使用方法
1. 编辑笔记
2. 输入内容
3. 点击 "AI 标签建议"
4. 查看建议的标签
5. 选择要添加的标签

### AI 内容格式化

#### 使用方法
1. 编辑笔记
2. 选择要格式化的内容
3. 点击 "AI 格式化" 按钮
4. 选择格式化选项：
   - 修正语法
   - 优化排版
   - 添加标题
   - 生成目录
5. 查看格式化结果

### AI 配置
- **位置**: 设置 → AI 配置
- **选项**:
  - API 密钥
  - 模型选择
  - 温度参数
  - 最大 token 数

---

## 快捷键

### 全局快捷键
- `Ctrl+K` / `Cmd+K` - 打开搜索
- `Ctrl+N` / `Cmd+N` - 新建笔记
- `Ctrl+S` / `Cmd+S` - 保存笔记
- `Ctrl+/` / `Cmd+/` - 显示快捷键帮助

### 编辑器快捷键
- `Ctrl+B` / `Cmd+B` - 加粗
- `Ctrl+I` / `Cmd+I` - 斜体
- `Ctrl+L` / `Cmd+L` - 插入链接
- `Ctrl+Shift+C` / `Cmd+Shift+C` - 插入代码块

---

## 常见问题

### Q: 如何启动协作编辑功能？
A: 需要启动 WebSocket 服务器：`npm run dev:collab`

### Q: 图片上传失败怎么办？
A: 检查 Supabase 存储配置，确保 bucket 已创建并设置了正确的权限。

### Q: 离线模式下能使用哪些功能？
A: 可以创建、编辑、删除笔记，数据保存在本地，网络恢复后自动同步。

### Q: 如何导出所有笔记？
A: 目前支持单个笔记导出，批量导出功能正在开发中。

### Q: PWA 安装后如何更新？
A: 应用会自动检测更新，刷新页面即可更新到最新版本。

---

## 技术支持

如有问题或建议，请：
1. 查看文档目录中的其他指南
2. 提交 GitHub Issue
3. 联系技术支持团队

---

**最后更新**: 2024-12-08
