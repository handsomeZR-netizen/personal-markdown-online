# 🧪 手动测试指南

## ✅ 自动化测试结果

```
✅ 服务器正常运行
✅ API 认证保护正常
✅ Supabase 客户端已配置
```

## 🚀 开始测试

### 服务器信息
- **地址**: http://localhost:3001
- **状态**: ✅ 运行中

---

## 📋 测试步骤

### 1️⃣ 用户注册

1. 访问 http://localhost:3001
2. 点击"注册"或访问 http://localhost:3001/register
3. 填写信息:
   - 邮箱: test@example.com
   - 密码: test123456
   - 姓名: Test User
4. 点击"注册"

**预期结果**:
- ✅ 注册成功，跳转到登录页面
- ❌ 如果出现 "permission denied" 错误，见下方"权限问题解决"

### 2️⃣ 用户登录

1. 访问 http://localhost:3001/login
2. 输入刚才注册的账号:
   - 邮箱: test@example.com
   - 密码: test123456
3. 点击"登录"

**预期结果**:
- ✅ 登录成功，跳转到 Dashboard
- ❌ 如果登录失败，检查密码是否正确

### 3️⃣ 创建笔记

1. 在 Dashboard 点击"新建笔记"
2. 填写:
   - 标题: "测试笔记"
   - 内容: "这是一个测试笔记，用于验证 Supabase SDK 集成。"
3. 点击"保存"

**预期结果**:
- ✅ 笔记创建成功
- ✅ 在笔记列表中看到新笔记
- ❌ 如果出现错误，见下方"权限问题解决"

### 4️⃣ 编辑笔记

1. 点击刚创建的笔记
2. 修改内容
3. 保存

**预期结果**:
- ✅ 笔记更新成功
- ✅ 刷新页面后修改仍然存在

### 5️⃣ 删除笔记

1. 在笔记列表找到测试笔记
2. 点击删除按钮
3. 确认删除

**预期结果**:
- ✅ 笔记删除成功
- ✅ 笔记从列表中消失

### 6️⃣ 离线功能测试

1. 创建一个新笔记
2. 断开网络（关闭 WiFi 或拔网线）
3. 尝试编辑笔记
4. 重新连接网络

**预期结果**:
- ✅ 离线时可以编辑
- ✅ 重新连接后自动同步

---

## ⚠️ 权限问题解决

如果遇到 `permission denied for schema public` 错误：

### 方案 1: 运行权限脚本（推荐）

1. 访问 Supabase SQL Editor:
   https://supabase.com/dashboard/project/llroqdgpohslhfejwxrn/sql/new

2. 复制 `supabase-grant-permissions.sql` 的内容

3. 粘贴并点击"Run"

4. 刷新应用页面重试

### 方案 2: 使用 Service Role Key

1. 获取 Service Role Key:
   https://supabase.com/dashboard/project/llroqdgpohslhfejwxrn/settings/api

2. 添加到 `.env.local`:
```env
SUPABASE_SERVICE_ROLE_KEY=你的service_role_key
```

3. 重启服务器:
```bash
Ctrl+C
npm run dev
```

---

## 📊 测试检查清单

### 基础功能
- [ ] 注册新用户
- [ ] 登录
- [ ] 查看 Dashboard
- [ ] 登出

### 笔记管理
- [ ] 创建笔记
- [ ] 查看笔记列表
- [ ] 编辑笔记
- [ ] 删除笔记
- [ ] 搜索笔记

### 高级功能
- [ ] 离线创建笔记
- [ ] 离线编辑笔记
- [ ] 重新连接后同步
- [ ] AI 自动摘要（内容超过 200 字）

### 性能测试
- [ ] 页面加载速度正常
- [ ] 笔记保存速度正常
- [ ] 无明显卡顿

---

## 🐛 常见问题

### 问题 1: "permission denied for schema public"
**原因**: Supabase RLS 权限未配置  
**解决**: 运行 `supabase-grant-permissions.sql`

### 问题 2: "Can't reach database server"
**原因**: 这是旧的 Prisma 错误，可以忽略  
**说明**: 应用现在使用 Supabase SDK，不再需要 Prisma 直连

### 问题 3: 注册后无法登录
**原因**: 密码可能输入错误  
**解决**: 重新注册一个新账号

### 问题 4: 笔记无法保存
**原因**: 权限问题或网络问题  
**解决**: 
1. 检查浏览器控制台错误
2. 运行权限脚本
3. 检查网络连接

---

## 🎯 测试成功标准

### 必须通过
- ✅ 可以注册新用户
- ✅ 可以登录
- ✅ 可以创建笔记
- ✅ 可以编辑笔记
- ✅ 可以删除笔记

### 建议测试
- ✅ 离线功能正常
- ✅ AI 摘要生成
- ✅ 数据持久化

---

## 📝 测试报告模板

测试完成后，记录结果：

```
测试日期: ___________
测试人员: ___________

基础功能:
- 注册: [ ] 通过 [ ] 失败
- 登录: [ ] 通过 [ ] 失败
- 创建笔记: [ ] 通过 [ ] 失败
- 编辑笔记: [ ] 通过 [ ] 失败
- 删除笔记: [ ] 通过 [ ] 失败

高级功能:
- 离线功能: [ ] 通过 [ ] 失败
- AI 摘要: [ ] 通过 [ ] 失败

遇到的问题:
1. ___________
2. ___________

总体评价:
[ ] 完全正常
[ ] 基本正常，有小问题
[ ] 有严重问题
```

---

## 🎉 测试完成

如果所有测试通过，恭喜！你的应用已经成功迁移到 Supabase SDK！

**下一步**:
1. 部署到 Vercel
2. 配置生产环境的 RLS 策略
3. 开始正式使用

---

**当前服务器**: http://localhost:3001 ✅
