# 移动应用使用指南

## 概述

团队协作知识库提供完整的移动端支持，包括 PWA（渐进式 Web 应用）功能、手势操作和键盘优化。本指南将帮助您在移动设备上获得最佳体验。

## 安装 PWA

### iOS (iPhone/iPad)

1. **打开 Safari 浏览器**：
   - 在 Safari 中访问应用网址
   - 其他浏览器不支持 PWA 安装

2. **添加到主屏幕**：
   - 点击底部的"分享"按钮（方框带向上箭头）
   - 滚动找到"添加到主屏幕"
   - 点击"添加"

3. **打开应用**：
   - 在主屏幕找到应用图标
   - 点击图标以全屏模式打开
   - 应用会隐藏浏览器地址栏

### Android

1. **打开 Chrome 浏览器**：
   - 在 Chrome 中访问应用网址
   - 系统会自动显示"添加到主屏幕"提示

2. **安装应用**：
   - 点击提示横幅中的"安装"按钮
   - 或点击菜单 → "添加到主屏幕"
   - 确认安装

3. **打开应用**：
   - 在应用抽屉或主屏幕找到图标
   - 点击图标以独立应用模式打开

### PWA 优势

- **全屏体验**：隐藏浏览器 UI，更像原生应用
- **离线访问**：缓存内容，无网络时也能查看
- **快速启动**：从主屏幕直接打开，无需输入网址
- **推送通知**：接收重要更新（需授权）
- **自动更新**：后台下载新版本，下次启动时应用

## 手势操作

### 侧边栏手势

#### 打开侧边栏
- **手势**：从屏幕左边缘向右滑动
- **滑动距离**：至少 50 像素
- **效果**：显示文件夹树和笔记列表

#### 关闭侧边栏
- **手势**：在侧边栏打开时向左滑动
- **或**：点击侧边栏外的区域
- **效果**：隐藏侧边栏，回到笔记内容

### 下拉刷新

#### 刷新笔记列表
- **手势**：在笔记列表顶部向下拉动
- **拉动距离**：至少 100 像素
- **效果**：显示刷新指示器，重新加载最新笔记

#### 刷新当前笔记
- **手势**：在笔记内容顶部向下拉动
- **效果**：同步最新内容和协作者更新

### 笔记卡片滑动

#### 显示快捷操作
- **手势**：在笔记卡片上向左滑动
- **效果**：显示"编辑"和"删除"按钮
- **操作**：点击按钮执行对应操作

#### 隐藏快捷操作
- **手势**：向右滑动或点击其他区域
- **效果**：隐藏操作按钮

### 双击操作

#### 快速编辑
- **手势**：双击笔记标题
- **间隔**：两次点击间隔小于 300 毫秒
- **效果**：直接进入编辑模式

### 手势识别规则

- **滑动阈值**：50 像素（防止误触）
- **方向判断**：水平滑动优先于垂直滑动
- **边缘检测**：侧边栏手势仅在屏幕边缘 20 像素内生效
- **冲突处理**：编辑模式下禁用部分手势

## 底部导航栏

### 导航标签

移动端在屏幕底部显示固定导航栏，包含 4 个标签：

#### 1. 笔记 📝
- **功能**：显示所有笔记列表
- **视图**：卡片式布局，支持滑动操作
- **排序**：按修改时间、创建时间或名称排序

#### 2. 搜索 🔍
- **功能**：搜索笔记和文件夹
- **特性**：实时搜索，高亮匹配文本
- **快捷**：无结果时快速创建新笔记

#### 3. 新建 ➕
- **功能**：快速创建新笔记
- **操作**：点击后直接进入编辑模式
- **位置**：可选择保存到的文件夹

#### 4. 目录 📁
- **功能**：显示文件夹树状结构
- **操作**：展开/折叠文件夹，拖拽移动笔记
- **导航**：点击文件夹查看其中的笔记

### 导航行为

- **固定位置**：始终固定在屏幕底部
- **活动高亮**：当前标签会高亮显示
- **滚动保持**：滚动内容时导航栏保持可见
- **编辑隐藏**：进入编辑模式时自动隐藏，最大化编辑区域

## 键盘优化

### 自动适配

当键盘弹出时，系统会自动：

1. **调整视口**：
   - 编辑器高度自动缩小
   - 确保光标位置可见
   - 避免内容被键盘遮挡

2. **滚动到光标**：
   - 自动滚动使光标位于可见区域
   - 光标距离键盘顶部至少 20 像素
   - 平滑动画过渡（200 毫秒）

3. **恢复布局**：
   - 键盘收起时恢复原始高度
   - 保持滚动位置
   - 平滑过渡动画

### 键盘工具栏

编辑器顶部显示简化工具栏：

- **格式化**：加粗、斜体、下划线
- **标题**：H1、H2、H3
- **列表**：无序列表、有序列表
- **插入**：图片、链接
- **完成**：保存并关闭键盘

### 输入优化

- **自动聚焦**：进入编辑模式时自动聚焦输入框
- **防止跳动**：使用 Visual Viewport API 精确计算
- **触摸目标**：所有按钮至少 44x44 像素
- **防误触**：增加按钮间距

## 离线功能

### 离线访问

PWA 支持离线访问已缓存的内容：

1. **自动缓存**：
   - 首次访问时缓存核心资源
   - 浏览过的笔记自动缓存
   - 图片按需缓存

2. **离线编辑**：
   - 无网络时可以继续编辑
   - 修改保存在本地
   - 重新连接后自动同步

3. **离线指示器**：
   - 顶部显示"离线"状态
   - 提示哪些功能不可用
   - 显示待同步的修改数量

### 缓存管理

在设置中可以管理缓存：

- **查看缓存大小**：显示已缓存的数据量
- **清除缓存**：释放存储空间
- **选择缓存策略**：
  - 仅缓存最近访问的笔记
  - 缓存所有笔记（需要更多空间）
  - 不缓存（仅在线模式）

## 移动端编辑器

### 工具栏

移动端编辑器提供简化工具栏：

#### 基础格式
- **B**：加粗
- **I**：斜体
- **U**：下划线
- **S**：删除线

#### 标题
- **H1**：一级标题
- **H2**：二级标题
- **H3**：三级标题

#### 列表
- **•**：无序列表
- **1.**：有序列表
- **☑**：任务列表

#### 插入
- **🖼**：插入图片
- **🔗**：插入链接
- **💻**：代码块

### 图片上传

移动端支持多种图片上传方式：

1. **拍照上传**：
   - 点击图片按钮
   - 选择"拍照"
   - 拍摄后自动上传

2. **相册选择**：
   - 点击图片按钮
   - 选择"从相册选择"
   - 支持多选

3. **粘贴上传**：
   - 从其他应用复制图片
   - 在编辑器中粘贴
   - 自动上传并插入

### 文本选择

- **长按选择**：长按文本开始选择
- **拖动手柄**：拖动选择范围的起止点
- **快捷菜单**：选中后显示格式化选项
- **全选**：双击段落全选该段

## 性能优化

### 加载优化

- **首屏加载**：< 2 秒
- **代码分割**：按需加载功能模块
- **图片懒加载**：滚动到可见区域才加载
- **预加载**：预测用户行为，提前加载

### 交互优化

- **响应时间**：< 100 毫秒
- **动画流畅**：60 FPS
- **防抖处理**：搜索输入延迟 300 毫秒
- **节流处理**：滚动事件每 16 毫秒触发一次

### 内存优化

- **虚拟滚动**：大列表仅渲染可见项
- **图片压缩**：自动压缩大图片
- **缓存限制**：最多缓存 100 个笔记
- **定期清理**：自动清理过期缓存

## 最佳实践

### 网络使用

1. **WiFi 优先**：
   - 大文件操作使用 WiFi
   - 移动网络下限制图片上传大小
   - 自动暂停后台同步

2. **流量节省**：
   - 启用"仅 WiFi 同步"选项
   - 禁用自动图片加载
   - 使用低质量图片预览

### 电池优化

1. **后台限制**：
   - 应用在后台时暂停同步
   - 减少 WebSocket 心跳频率
   - 延迟非关键更新

2. **省电模式**：
   - 检测系统省电模式
   - 自动降低同步频率
   - 禁用动画效果

### 存储管理

1. **定期清理**：
   - 每周清理一次缓存
   - 删除不需要的离线笔记
   - 压缩历史版本

2. **空间监控**：
   - 查看存储使用情况
   - 设置存储限制
   - 接近限制时收到提醒

## 常见问题

### Q: 为什么无法安装 PWA？

A: 可能的原因：
- iOS 必须使用 Safari 浏览器
- Android 必须使用 Chrome 浏览器
- 网站必须使用 HTTPS
- 检查浏览器版本是否过旧

### Q: 手势不响应怎么办？

A: 尝试：
- 确保滑动距离超过 50 像素
- 检查是否在正确的区域滑动
- 刷新页面重试
- 检查是否在编辑模式（部分手势被禁用）

### Q: 键盘遮挡输入框？

A: 系统应该自动调整，如果没有：
- 手动滚动到光标位置
- 刷新页面重试
- 检查浏览器版本
- 尝试横屏模式

### Q: 离线编辑的内容会丢失吗？

A: 不会。离线编辑的内容：
- 保存在本地 IndexedDB
- 重新连接后自动同步
- 即使关闭应用也不会丢失
- 建议定期连接网络同步

### Q: 如何卸载 PWA？

A: 
- **iOS**：长按图标 → 删除应用
- **Android**：长按图标 → 卸载 / 应用信息 → 卸载
- 卸载后缓存数据会被清除

## 快捷手势总结

| 手势 | 操作 | 效果 |
|------|------|------|
| 从左边缘向右滑 | 打开侧边栏 | 显示文件夹树 |
| 向左滑 | 关闭侧边栏 | 隐藏侧边栏 |
| 顶部下拉 | 刷新 | 重新加载内容 |
| 笔记卡片左滑 | 显示操作 | 显示编辑/删除按钮 |
| 双击标题 | 快速编辑 | 进入编辑模式 |
| 长按文本 | 选择文本 | 开始文本选择 |

## 技术支持

如果遇到问题：
1. 检查网络连接
2. 更新到最新版本浏览器
3. 清除浏览器缓存
4. 重新安装 PWA
5. 联系技术支持团队
