# æ•°æ®åº“è¿æ¥é”™è¯¯ - åŸå› å’Œè§£å†³æ–¹æ¡ˆ

## âŒ é”™è¯¯ä¿¡æ¯
```
Error: Can't reach database server at `db.llroqdgpohslhfejwxrn.supabase.co:5432`
```

## ğŸ” è¯Šæ–­ç»“æœ

æˆ‘å·²ç»è¿è¡Œäº†å®Œæ•´çš„ç½‘ç»œè¯Šæ–­ï¼Œç»“æœæ˜¾ç¤ºï¼š
- âœ… DNS è§£ææˆåŠŸ
- âŒ ç«¯å£ 5432 (ç›´è¿) æ— æ³•è®¿é—®
- âŒ ç«¯å£ 6543 (è¿æ¥æ± ) æ— æ³•è®¿é—®

## ğŸ’¡ æ ¹æœ¬åŸå› 

**ä½ çš„ Supabase æ•°æ®åº“å·²ç»æš‚åœäº†ï¼**

Supabase å…è´¹ç‰ˆæœ‰ä»¥ä¸‹é™åˆ¶ï¼š
- ğŸ• **7 å¤©æ— æ´»åŠ¨åè‡ªåŠ¨æš‚åœ**
- ğŸ—‘ï¸ æš‚åœ 90 å¤©åæ°¸ä¹…åˆ é™¤

ä½ çš„é…ç½®æ˜¯æ­£ç¡®çš„ï¼Œé—®é¢˜ä¸åœ¨ä»£ç ï¼Œè€Œæ˜¯æ•°æ®åº“æœåŠ¡æœ¬èº«å·²ç»åœæ­¢è¿è¡Œã€‚

## âœ… è§£å†³æ–¹æ¡ˆï¼ˆ3 æ­¥ï¼‰

### ç¬¬ 1 æ­¥ï¼šæ¢å¤æ•°æ®åº“
1. è®¿é—®ä½ çš„ Supabase é¡¹ç›®ï¼š
   ```
   https://supabase.com/dashboard/project/llroqdgpohslhfejwxrn
   ```

2. æŸ¥çœ‹é¡¹ç›®çŠ¶æ€ï¼š
   - å¦‚æœæ˜¾ç¤º **"Paused"** æˆ– **"Inactive"**
   - ç‚¹å‡» **"Resume"** æˆ– **"Restore"** æŒ‰é’®

3. ç­‰å¾… 1-2 åˆ†é’Ÿè®©æ•°æ®åº“å®Œå…¨å¯åŠ¨

### ç¬¬ 2 æ­¥ï¼šéªŒè¯è¿æ¥
æ•°æ®åº“æ¢å¤åï¼Œè¿è¡Œæµ‹è¯•ï¼š
```bash
cd note-app
npm run db:test
```

### ç¬¬ 3 æ­¥ï¼šé˜²æ­¢å†æ¬¡æš‚åœ

**é€‰é¡¹ Aï¼šå®šæœŸè®¿é—®ï¼ˆæœ€ç®€å•ï¼‰**
- æ¯å‘¨è‡³å°‘è®¿é—®ä¸€æ¬¡ä½ çš„åº”ç”¨
- æˆ–æ¯å‘¨è¿è¡Œä¸€æ¬¡ `npm run db:test`

**é€‰é¡¹ Bï¼šè®¾ç½®è‡ªåŠ¨å¥åº·æ£€æŸ¥ï¼ˆæ¨èï¼‰**

åœ¨ `vercel.json` ä¸­æ·»åŠ  Cron Jobï¼š
```json
{
  "crons": [{
    "path": "/api/cron/keep-alive",
    "schedule": "0 0 * * *"
  }]
}
```

åˆ›å»ºå¥åº·æ£€æŸ¥ APIï¼š
```typescript
// app/api/cron/keep-alive/route.ts
import { prisma } from '@/lib/prisma';

export async function GET() {
  try {
    await prisma.$queryRaw`SELECT 1`;
    return Response.json({ status: 'ok', time: new Date() });
  } catch (error) {
    return Response.json({ status: 'error' }, { status: 500 });
  }
}
```

**é€‰é¡¹ Cï¼šå‡çº§åˆ°ä»˜è´¹è®¡åˆ’**
- Supabase Pro: $25/æœˆ
- ä¸ä¼šè‡ªåŠ¨æš‚åœ
- æ›´å¤šèµ„æºå’ŒåŠŸèƒ½

## ğŸ› ï¸ è¯Šæ–­å·¥å…·

æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†è¯Šæ–­è„šæœ¬ï¼Œéšæ—¶å¯ä»¥è¿è¡Œï¼š

```bash
# Windows PowerShell
cd note-app
powershell -ExecutionPolicy Bypass -File scripts/diagnose-connection.ps1

# æˆ–è€…æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run db:test
```

## ğŸ“Š ä½ çš„é…ç½®ï¼ˆå·²éªŒè¯æ­£ç¡®ï¼‰

```env
# è¿æ¥æ±  - ç”¨äºåº”ç”¨æŸ¥è¯¢
DATABASE_URL="postgresql://postgres:***@db.llroqdgpohslhfejwxrn.supabase.co:6543/postgres?pgbouncer=true"

# ç›´è¿ - ç”¨äºæ•°æ®åº“è¿ç§»
DIRECT_URL="postgresql://postgres:***@db.llroqdgpohslhfejwxrn.supabase.co:5432/postgres"
```

é…ç½®æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯æ•°æ®åº“æœåŠ¡æš‚åœäº†ã€‚

## ğŸ¯ ç«‹å³è¡ŒåŠ¨

1. æ‰“å¼€æµè§ˆå™¨
2. è®¿é—® https://supabase.com/dashboard/project/llroqdgpohslhfejwxrn
3. ç‚¹å‡» "Resume"
4. ç­‰å¾… 1-2 åˆ†é’Ÿ
5. è¿è¡Œ `npm run db:test`

å°±è¿™ä¹ˆç®€å•ï¼

## â“ éœ€è¦è¡¥å……çš„ä¿¡æ¯

å¦‚æœæ¢å¤æ•°æ®åº“åä»ç„¶æ— æ³•è¿æ¥ï¼Œè¯·æä¾›ï¼š
1. Supabase Dashboard ä¸­æ˜¾ç¤ºçš„é¡¹ç›®çŠ¶æ€æˆªå›¾
2. è¿è¡Œ `npm run db:test` çš„å®Œæ•´è¾“å‡º
3. Supabase é¡¹ç›®è®¾ç½®ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯æˆªå›¾

ä½†æ ¹æ®æˆ‘çš„è¯Šæ–­ï¼Œ99% çš„å¯èƒ½æ€§å°±æ˜¯æ•°æ®åº“æš‚åœäº†ã€‚
