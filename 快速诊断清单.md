# ğŸ” Supabase æ•°æ®åº“è¿æ¥é—®é¢˜ - å¿«é€Ÿè¯Šæ–­æ¸…å•

## é”™è¯¯ä¿¡æ¯
```
Can't reach database server at `db.llroqdgpohslhfejwxrn.supabase.co:5432`
```

---

## âœ… ç¬¬ 1 æ­¥ï¼šæ£€æŸ¥æ•°æ®åº“çŠ¶æ€ï¼ˆæœ€é‡è¦ï¼ï¼‰

### æ“ä½œï¼š
1. æ‰“å¼€æµè§ˆå™¨
2. è®¿é—®ï¼šhttps://supabase.com/dashboard/project/llroqdgpohslhfejwxrn
3. æŸ¥çœ‹é¡¹ç›®çŠ¶æ€

### åˆ¤æ–­ï¼š
- âœ… å¦‚æœæ˜¾ç¤º **"Active"** æˆ– **"Healthy"** â†’ ç»§ç»­ç¬¬ 2 æ­¥
- âŒ å¦‚æœæ˜¾ç¤º **"Paused"** æˆ– **"Inactive"** â†’ **ç‚¹å‡» "Resume" æŒ‰é’®**

### æ¢å¤åï¼š
```bash
# ç­‰å¾… 1-2 åˆ†é’Ÿï¼Œç„¶åæµ‹è¯•
cd note-app
npm run db:test
```

**å¦‚æœæˆåŠŸ â†’ é—®é¢˜è§£å†³ï¼ğŸ‰**

---

## âœ… ç¬¬ 2 æ­¥ï¼šè¿è¡Œç½‘ç»œè¯Šæ–­

å¦‚æœæ•°æ®åº“æ˜¾ç¤º Active ä½†ä»ç„¶æ— æ³•è¿æ¥ï¼š

```bash
cd note-app
powershell -ExecutionPolicy Bypass -File scripts/diagnose-connection.ps1
```

### æŸ¥çœ‹ç»“æœï¼š
- âœ… å¦‚æœç«¯å£ 5432 æˆ– 6543 å¯è®¿é—® â†’ ç»§ç»­ç¬¬ 3 æ­¥
- âŒ å¦‚æœä¸¤ä¸ªç«¯å£éƒ½ä¸å¯è®¿é—® â†’ æ•°æ®åº“å¯èƒ½åˆšæ¢å¤ï¼Œç­‰å¾… 2 åˆ†é’Ÿåé‡è¯•

---

## âœ… ç¬¬ 3 æ­¥ï¼šæ£€æŸ¥ç¯å¢ƒå˜é‡

```bash
cd note-app
npm run db:test
```

### å¦‚æœæ˜¾ç¤º "DATABASE_URL æœªè®¾ç½®"ï¼š

æ£€æŸ¥ `.env` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š
```bash
# Windows
type .env

# åº”è¯¥çœ‹åˆ°ï¼š
DATABASE_URL="postgresql://postgres:151692483515156555878@db.llroqdgpohslhfejwxrn.supabase.co:6543/postgres?pgbouncer=true"
DIRECT_URL="postgresql://postgres:151692483515156555878@db.llroqdgpohslhfejwxrn.supabase.co:5432/postgres"
```

---

## âœ… ç¬¬ 4 æ­¥ï¼šæ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®

### æ“ä½œï¼š
1. è®¿é—®ï¼šhttps://supabase.com/dashboard/project/llroqdgpohslhfejwxrn/settings/database
2. æ‰¾åˆ° "Database Password" éƒ¨åˆ†
3. å¦‚æœå¿˜è®°å¯†ç ï¼Œç‚¹å‡» "Reset Database Password"
4. å¤åˆ¶æ–°å¯†ç 
5. æ›´æ–° `.env` æ–‡ä»¶ä¸­çš„å¯†ç 

---

## âœ… ç¬¬ 5 æ­¥ï¼šæ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²æ ¼å¼

### ä» Supabase Dashboard è·å–æœ€æ–°è¿æ¥å­—ç¬¦ä¸²ï¼š

1. è®¿é—®ï¼šhttps://supabase.com/dashboard/project/llroqdgpohslhfejwxrn/settings/database
2. æ‰¾åˆ° "Connection String" éƒ¨åˆ†
3. é€‰æ‹© "Transaction Pooler" (ç«¯å£ 6543)
4. å¤åˆ¶è¿æ¥å­—ç¬¦ä¸²
5. å¯¹æ¯”ä½ çš„ `.env` æ–‡ä»¶

### æ­£ç¡®æ ¼å¼ï¼š
```env
# è¿æ¥æ± ï¼ˆæ¨èï¼‰
DATABASE_URL="postgresql://postgres:[YOUR-PASSWORD]@db.llroqdgpohslhfejwxrn.supabase.co:6543/postgres?pgbouncer=true"

# ç›´è¿ï¼ˆç”¨äºè¿ç§»ï¼‰
DIRECT_URL="postgresql://postgres:[YOUR-PASSWORD]@db.llroqdgpohslhfejwxrn.supabase.co:5432/postgres"
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: éœ€è¦é…ç½® URL Configuration å—ï¼Ÿ
**A**: âŒ ä¸éœ€è¦ï¼URL Configuration åªå½±å“è®¤è¯ï¼ˆOAuthï¼‰ï¼Œä¸å½±å“æ•°æ®åº“è¿æ¥ã€‚

### Q2: éœ€è¦æ·»åŠ åŸŸååˆ°ç™½åå•å—ï¼Ÿ
**A**: âŒ ä¸éœ€è¦ï¼Supabase å…è´¹ç‰ˆé»˜è®¤å…è®¸æ‰€æœ‰ IPã€‚

### Q3: éœ€è¦é…ç½® CORS å—ï¼Ÿ
**A**: âŒ ä¸éœ€è¦ï¼CORS åªå½±å“æµè§ˆå™¨è¯·æ±‚ï¼ŒPrisma æ˜¯æœåŠ¡ç«¯è¿æ¥ã€‚

### Q4: IPv4/IPv6 å…¼å®¹æ€§é—®é¢˜ï¼Ÿ
**A**: âš ï¸ å¯èƒ½ã€‚å¦‚æœä½ çš„ç¯å¢ƒä¸æ”¯æŒ IPv6ï¼š
- ä½¿ç”¨ç«¯å£ 6543 (Connection Pooler) è€Œä¸æ˜¯ 5432
- Connection Pooler æ”¯æŒ IPv4

### Q5: ä¸ºä»€ä¹ˆä¼šè‡ªåŠ¨æš‚åœï¼Ÿ
**A**: Supabase å…è´¹ç‰ˆåœ¨ 7 å¤©æ— æ´»åŠ¨åè‡ªåŠ¨æš‚åœã€‚

---

## ğŸ¯ æœ€å¯èƒ½çš„åŸå› æ’åº

1. **æ•°æ®åº“å·²æš‚åœ** (90% å¯èƒ½æ€§)
   - è§£å†³ï¼šå» Dashboard ç‚¹å‡» Resume

2. **åˆšæ¢å¤ï¼Œè¿˜åœ¨å¯åŠ¨ä¸­** (5% å¯èƒ½æ€§)
   - è§£å†³ï¼šç­‰å¾… 1-2 åˆ†é’Ÿ

3. **å¯†ç é”™è¯¯** (3% å¯èƒ½æ€§)
   - è§£å†³ï¼šé‡ç½®å¯†ç å¹¶æ›´æ–° .env

4. **ç½‘ç»œé—®é¢˜** (1% å¯èƒ½æ€§)
   - è§£å†³ï¼šæ£€æŸ¥é˜²ç«å¢™ã€VPN

5. **URL Configuration é—®é¢˜** (0% å¯èƒ½æ€§)
   - è¿™ä¸å½±å“æ•°æ®åº“è¿æ¥ï¼

---

## ğŸ“ éœ€è¦æ›´å¤šå¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³ï¼Œè¯·æä¾›ï¼š

1. **Supabase Dashboard æˆªå›¾**
   - é¡¹ç›®çŠ¶æ€é¡µé¢
   - Database Settings é¡µé¢

2. **è¯Šæ–­è„šæœ¬è¾“å‡º**
   ```bash
   powershell -ExecutionPolicy Bypass -File scripts/diagnose-connection.ps1
   ```

3. **æµ‹è¯•è¿æ¥è¾“å‡º**
   ```bash
   npm run db:test
   ```

4. **ç¯å¢ƒå˜é‡æ£€æŸ¥**ï¼ˆéšè—å¯†ç ï¼‰
   ```bash
   # æ˜¾ç¤ºå‰ 50 ä¸ªå­—ç¬¦
   echo $env:DATABASE_URL.Substring(0, 50)
   ```

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# 1. æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run db:test

# 2. è¿è¡Œç½‘ç»œè¯Šæ–­
powershell -ExecutionPolicy Bypass -File scripts/diagnose-connection.ps1

# 3. æŸ¥çœ‹ç¯å¢ƒå˜é‡
type .env

# 4. ç”Ÿæˆ Prisma Client
npm run db:generate

# 5. è¿è¡Œæ•°æ®åº“è¿ç§»
npm run db:push
```

---

**è®°ä½**ï¼š99% çš„æƒ…å†µä¸‹ï¼Œé—®é¢˜å°±æ˜¯æ•°æ®åº“æš‚åœäº†ã€‚å» Dashboard ç‚¹å‡» Resume å°±å¥½ï¼
